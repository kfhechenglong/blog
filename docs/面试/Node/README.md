## 使用一个 Node 中间件解决前端跨越问题

用 node 写一个前端跨域的中间件

## 模拟一个 V8 引擎解析器

## 构建工具的优势

在现代使用现代框架时，都会基于一个构建工具协助开发和打包编译，使用构建工具有以下优势：

- 可以方便使用现代框架，例如 Vue、React 等。
- 可以使用 ES 的 export 等特性进行模块化管理，抽离模块、组件并交给构建工具打包处理。
- 优化代码体积，利用打包工具的 tree-skaking 特性移除无用代码，懒加载和 Chunk 分割，对代码进行压缩。
- 对海量的 npm 包支持开箱即用，构建工具负责按需抽离合并。
- 可以使用 CSS 等 Sass、less 等预处理器，提高 Css 的开发效率。
- 对 TypeScript 的友好支持，开发工具进行编译处理。
- 可以使用 ESlint、StyleLint 等代码风格校验、git hooks 工具。

## Node 版本的知识点

node 的版本有 LTS 和 Current 之分，并且拥有不同的版本号。

current 版本是最新发布版本，里面包含这个版本系列的最新功能，但是有些功能需求完善或者修复做兼容处理。

node 每 6 个月就会发布一次 Current 版本，其中新偶数版本每年 4 月份发布，奇数版本每年的 10 月份发布。每个版本会在这个阶段持续活跃 6 个月，期间进行维护和更新。但是满 6 个月以后将有以下区别：

- 其中如果大版本是奇数，将不再进行支持，不会进入到 LTS 版本阶段。
- 如果大版本是偶数，则进行到 LTS 阶段，并且作为活跃的稳定版投入使用。

LTS 版本，全程 Long Time Support 即长期维护版本。每个 LTS 版本大概会进行长达 30 个月的维护时间，其中会经历 Active 阶段（大约是 18 个月）进行积极维护和升级，然后经历 Maintenance 阶段（大约 12 个月）进行错误修复和安全补丁。

## 关于 package.json 中的 Type

`package.json`中的 type 字段是关于模块规范的定义，有两个值可供选择`commonjs`和`module`，其中`commonjs`是默认值。

- 当设置为`commonjs`时，拓展名称为`.js`和`.cj`的文件都是`commonjs`规范的模块，如果要使用`ES Module`规范，则需要使用`.mjs`为拓展名。
- 当设置为`module`时，拓展名称为`.js`和`.mjs`的文件都是`ES Module`规范的模块，如果使用`commonjs`规范，则需要使用`.mjs`作为拓展名.

更多信息，请参考[npm Docs](https://docs.npmjs.com/cli/v8/configuring-npm/package-json)

## npm包版本号的理解

npm包在发布时，需要按照[包版本语义化](https://semver.org/lang/zh-CN/)中的约定去更新设置，例如我们常见的`1.0.0`，`1.0.1`，`0.0.1`等这样的版本号，那么这些数字分别代表什么意思呢？下面我们将详细介绍。

### npm版本号的组成

一个完整的版本号，由三部分组成：主版本号（major）、次版本号(minor)、修订版本号(patch)，简称`X.Y.Z`，具体含义：
- 主版本号（major）：项目（包）做了大量的变更，与旧的版本存在一定的不兼容性等问题。
- 次版本号（minor）：做了少量的变更或向下做了兼容。
- 修订版本号（patch）：修复上一个版本的bug或向下做兼容。

版本号变更的一般规则：
- 版本号只升不降，不得在数字前面加0。例如不能是`1.01.0`，应该是`1.0.0`。
- 当主版本号升级时，次版本号和修订版本号需要归零。例如`1.1.1`->`2.0.0`。
- 当次版本号升级时，主版本号不变，修订版本号归零。例如`1.1.1`->`1.2.0`。
- 当修订版本号升级时，主版本和次版本号都不变。例如`1.1.1`->`1.1.2`。
- 一般第一个正式版本应为`1.0.0`。
- 处于开发测试阶段的版本一般为`0.y.z`，如果不发布，则默认为`0.0.0`，如果发布第一个测试版本则是`0.1.0`，如果修复第一个测试版本则是`0.1.1`，如果更新第二个测试版本则是`0.2.0`。

### 版本标识符（标签）

格式：`Major.Minor.Patch-Identifier.1`，其中`Identifier`就是代表标识符，和版本号之间使用`-`隔离，后面则是当前标识符的版本版本号，每升级一次则+1
标识符|含义|说明
--|--|--
demo|demo版本|用于验证问题的版本
dev|开发版|多用于开发阶段，bug较多，功能不完善
alpha|α版本|内部版本，测试用，代表当前可能有很大的变动
beta| 测试版本（β版本）|测试版本，代表版本已开始稳定，但是还有bug
stable| 稳定版本|
latest|最新版本|安装时不知道版本号时的默认安装最新版本

希望安装带标签的版本，必须明确指定标签或者版本号，否则安装的是最新的不带标签的版本。

### 版本运算符

版本运算符一般是指定一定范围的版本号，主要有`~`、`-`、`^`、`<`、`>`等。

`~` 版本号只指定主版本号或者次版本号，例如：
版本范围|匹配版本号
--|--
~2|2.Y 或者 2.0.0 ≤ V < 4.0.0
~2.1|2.1.Z 或者 2.1.0 ≤ V < 2.2.0
~2.1.1|2.1.1 ≤ V < 2.2.0

`^` 版本号
匹配第一个非0版本号

版本范围|匹配版本号
--|--
^2.1.2|2.1.2 ≤ V < 3.0.0
^0.1.2|0.1.2 ≤ V < 0.2.0
^2.Y.Z|2.0.0 ≤ V < 3.0.0

npm 安装包时，默认使用 ^ 匹配版本。

`~` 与 `^` 对比
版本范围|匹配版本号|说明
--|--|--
~2.1.0 | 2.1.0 ≤ V < 2.2.0 | 主版本号和次版本号相同
^2.1.0 | 2.1.0 ≤ V < 3.0.0 | 主版本号相同